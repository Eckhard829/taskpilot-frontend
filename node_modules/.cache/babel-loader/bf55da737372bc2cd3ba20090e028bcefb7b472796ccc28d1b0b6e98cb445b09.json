{"ast":null,"code":"import React,{useState,useEffect}from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import Login from'./pages/Login';import AdminDashboard from'./pages/AdminDashboard';import WorkerDashboard from'./pages/WorkerDashboard';import CreateUser from'./pages/CreateUser';import'bootstrap/dist/css/bootstrap.min.css';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children,requiredRole}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const fetchUser=async()=>{try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/verify\"),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const data=await response.json();setUser(data.user);}else{setUser(null);}}catch(error){console.error('Error verifying user:',error);setUser(null);}finally{setLoading(false);}};fetchUser();},[]);if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true});}if(requiredRole&&user.role!==requiredRole){return/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true});}return children;};function App(){return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/*\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"admin\",children:/*#__PURE__*/_jsx(AdminDashboard,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/worker\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"worker\",children:/*#__PURE__*/_jsx(WorkerDashboard,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/create-user\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"admin\",children:/*#__PURE__*/_jsx(CreateUser,{})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","Navigate","Login","AdminDashboard","WorkerDashboard","CreateUser","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","children","requiredRole","user","setUser","loading","setLoading","fetchUser","response","fetch","concat","process","env","REACT_APP_API_URL","headers","localStorage","getItem","ok","data","json","error","console","to","replace","role","App","path","element"],"sources":["C:/Users/USER-PC/Desktop/TaskPilot/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\nimport Login from './pages/Login';\nimport AdminDashboard from './pages/AdminDashboard';\nimport WorkerDashboard from './pages/WorkerDashboard';\nimport CreateUser from './pages/CreateUser';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './App.css';\n\nconst ProtectedRoute = ({ children, requiredRole }) => {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      try {\n        const response = await fetch(`${process.env.REACT_APP_API_URL}/auth/verify`, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('token')}`,\n          },\n        });\n        if (response.ok) {\n          const data = await response.json();\n          setUser(data.user);\n        } else {\n          setUser(null);\n        }\n      } catch (error) {\n        console.error('Error verifying user:', error);\n        setUser(null);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchUser();\n  }, []);\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  if (!user) {\n    return <Navigate to=\"/\" replace />;\n  }\n\n  if (requiredRole && user.role !== requiredRole) {\n    return <Navigate to=\"/\" replace />;\n  }\n\n  return children;\n};\n\nfunction App() {\n  return (\n    <Router>\n      <Routes>\n        <Route path=\"/\" element={<Login />} />\n        <Route \n          path=\"/admin/*\" \n          element={\n            <ProtectedRoute requiredRole=\"admin\">\n              <AdminDashboard />\n            </ProtectedRoute>\n          } \n        />\n        <Route \n          path=\"/worker\" \n          element={\n            <ProtectedRoute requiredRole=\"worker\">\n              <WorkerDashboard />\n            </ProtectedRoute>\n          } \n        />\n        <Route \n          path=\"/create-user\" \n          element={\n            <ProtectedRoute requiredRole=\"admin\">\n              <CreateUser />\n            </ProtectedRoute>\n          } \n        />\n        <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n      </Routes>\n    </Router>\n  );\n}\n\nexport default App;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,aAAa,GAAI,CAAAC,MAAM,CAAEC,MAAM,CAAEC,KAAK,CAAEC,QAAQ,KAAQ,kBAAkB,CACnF,MAAO,CAAAC,KAAK,KAAM,eAAe,CACjC,MAAO,CAAAC,cAAc,KAAM,wBAAwB,CACnD,MAAO,CAAAC,eAAe,KAAM,yBAAyB,CACrD,MAAO,CAAAC,UAAU,KAAM,oBAAoB,CAC3C,MAAO,sCAAsC,CAC7C,MAAO,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnB,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAgC,IAA/B,CAAEC,QAAQ,CAAEC,YAAa,CAAC,CAAAF,IAAA,CAChD,KAAM,CAACG,IAAI,CAAEC,OAAO,CAAC,CAAGpB,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACqB,OAAO,CAAEC,UAAU,CAAC,CAAGtB,QAAQ,CAAC,IAAI,CAAC,CAE5CC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAsB,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,IAAAC,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,iBAAiB,iBAAgB,CAC3EC,OAAO,CAAE,CACP,eAAe,WAAAJ,MAAA,CAAYK,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC1D,CACF,CAAC,CAAC,CACF,GAAIR,QAAQ,CAACS,EAAE,CAAE,CACf,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAV,QAAQ,CAACW,IAAI,CAAC,CAAC,CAClCf,OAAO,CAACc,IAAI,CAACf,IAAI,CAAC,CACpB,CAAC,IAAM,CACLC,OAAO,CAAC,IAAI,CAAC,CACf,CACF,CAAE,MAAOgB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7ChB,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,OAAS,CACRE,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CACDC,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,EAAE,CAAC,CAEN,GAAIF,OAAO,CAAE,CACX,mBAAOT,IAAA,QAAAK,QAAA,CAAK,YAAU,CAAK,CAAC,CAC9B,CAEA,GAAI,CAACE,IAAI,CAAE,CACT,mBAAOP,IAAA,CAACN,QAAQ,EAACgC,EAAE,CAAC,GAAG,CAACC,OAAO,MAAE,CAAC,CACpC,CAEA,GAAIrB,YAAY,EAAIC,IAAI,CAACqB,IAAI,GAAKtB,YAAY,CAAE,CAC9C,mBAAON,IAAA,CAACN,QAAQ,EAACgC,EAAE,CAAC,GAAG,CAACC,OAAO,MAAE,CAAC,CACpC,CAEA,MAAO,CAAAtB,QAAQ,CACjB,CAAC,CAED,QAAS,CAAAwB,GAAGA,CAAA,CAAG,CACb,mBACE7B,IAAA,CAACT,MAAM,EAAAc,QAAA,cACLH,KAAA,CAACV,MAAM,EAAAa,QAAA,eACLL,IAAA,CAACP,KAAK,EAACqC,IAAI,CAAC,GAAG,CAACC,OAAO,cAAE/B,IAAA,CAACL,KAAK,GAAE,CAAE,CAAE,CAAC,cACtCK,IAAA,CAACP,KAAK,EACJqC,IAAI,CAAC,UAAU,CACfC,OAAO,cACL/B,IAAA,CAACG,cAAc,EAACG,YAAY,CAAC,OAAO,CAAAD,QAAA,cAClCL,IAAA,CAACJ,cAAc,GAAE,CAAC,CACJ,CACjB,CACF,CAAC,cACFI,IAAA,CAACP,KAAK,EACJqC,IAAI,CAAC,SAAS,CACdC,OAAO,cACL/B,IAAA,CAACG,cAAc,EAACG,YAAY,CAAC,QAAQ,CAAAD,QAAA,cACnCL,IAAA,CAACH,eAAe,GAAE,CAAC,CACL,CACjB,CACF,CAAC,cACFG,IAAA,CAACP,KAAK,EACJqC,IAAI,CAAC,cAAc,CACnBC,OAAO,cACL/B,IAAA,CAACG,cAAc,EAACG,YAAY,CAAC,OAAO,CAAAD,QAAA,cAClCL,IAAA,CAACF,UAAU,GAAE,CAAC,CACA,CACjB,CACF,CAAC,cACFE,IAAA,CAACP,KAAK,EAACqC,IAAI,CAAC,GAAG,CAACC,OAAO,cAAE/B,IAAA,CAACN,QAAQ,EAACgC,EAAE,CAAC,GAAG,CAACC,OAAO,MAAE,CAAE,CAAE,CAAC,EAClD,CAAC,CACH,CAAC,CAEb,CAEA,cAAe,CAAAE,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}